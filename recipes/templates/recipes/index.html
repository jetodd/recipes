{% extends 'recipes/base.html' %}

{% block content %}
<div class="row">
	<div class="col-lg-8">
		<form method='GET' action=''>
			<input type='text' name='q' placeholder='Search recipes' value="{{ request.GET.q }}" />
			<input type="submit" value="Search" />
		</form>
	
		{% if query %}
			<h3>Search results</h3>
			{% if queryset_list %}
			<div class="container">
  				<div class="row">
				{% for recipe in queryset_list %}
					<!--<li><a href="{% url 'recipes:detail' recipe.id %}">{{ recipe.title }}</a></li>-->
					<div class="col-md-4">
      					<div class="card">
      						<a href="{% url 'recipes:detail' recipe.id %}">
      							<div class="card-image">
	      					<img class="img-card" src="{{ recipe.image }}">
	      				</div>
		      				<div class="card-content">
		        				<h4 class="card-title">{{ recipe.title }}</h4>
		      				</div>
		      			</a>
	  					</div>
					</div>
				{% endfor %}
				</div>
			</div>
			</ul>
			{% else %}
				<p>No results</p>
			{% endif %}
		{% endif %}

			<h3>Newest recipes</h3>
			{% if latest_recipes_list %}
				<div class="container">
  					<div class="row">
					{% for recipe in latest_recipes_list %}
						<div class="col-md-4">
	      					<div class="card">
	      						<a href="{% url 'recipes:detail' recipe.id %}">
			  						<div class="card-image">
			      						<img class="img-card" src="{{ recipe.image }}">
			      					</div>
				      				<div class="card-content">
				        				<h4 class="card-title">{{ recipe.title }}</a></h4>
				      				</div>
		      					</a>
		  					</div>
						</div>
					{% endfor %}
					</div>
				</div>
			{% endif %}

		<h3>Most popular recipes</h3>
		{% if most_popular_recipes_list %}
		<div class="container">
  			<div class="row">
				{% for recipe in most_popular_recipes_list %}
					<div class="col-sm-4">
	  					<div class="card">
	  						<a href="{% url 'recipes:detail' recipe.id %}">
		  						<div class="card-image">
		      						<img class="img-card" src="{{ recipe.image }}">
		      					</div>
			      				<div class="card-content">
			        				<h4 class="card-title">{{ recipe.title }}</a></h4>
			      				</div>
		      				</a>
	  					</div>
					</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}
	</div>
	
	<div class="col-sm-3">
		{% if this_week %}
			<h3>This week</h3>
			<ul>
				{% for recipe in this_week %}
					<li><a href="{% url 'recipes:detail' recipe.id %}">{{ recipe.title }}</a>
						{% for item in shopping %}
							{% ifequal item.recipe.id recipe.id %}
								({{ item.name }})
							{% endifequal %}
						{% endfor %}
					</li>
				{% endfor %}
			</ul>
		{% endif %}

		{% if next_week %}
			<h3>Next week</h3>
			<ul>
				{% for recipe in next_week %}
					<li><a href="{% url 'recipes:detail' recipe.id %}">{{ recipe.title }}</a>
					{% for item in shopping %}
						{% ifequal item.recipe.id recipe.id %}
							({{ item.name }})
						{% endifequal %}
					{% endfor %}
				{% endfor %}
				</li>
			</ul>
			<form action="move" method="post">
				{% csrf_token %}
				<input class="btn btn-primary" type="submit" value="Move">
			</form>

		{% endif %}
		{% if tags_list %}
			<h3>Tags</h3>
		    <ul id="horizontal-list">
		    {% for tag in tags_list %}
		        <li><a href="{% url 'recipes:tag' tag.id %}">{{ tag.name }}</a></li>
		    {% endfor %}
		    </ul>
		{% endif %}
	</div>
</div>
</div>
{% endblock %}